

function Get-DownloadsFolderPathFromRegistry {
    $registryPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders"
    $valueName = "{374DE290-123F-4565-9164-39C4925E467B}"
    $downloadsFolderPath = (Get-ItemProperty -Path $registryPath -Name $valueName).$valueName

    # 展开可能存在的环境变量引用
    $expandedPath = [Environment]::ExpandEnvironmentVariables($downloadsFolderPath)

    # 移除字符串两端的空格
    $trimmedPath = $expandedPath.Trim()

    return $trimmedPath
}

$downloadsPath = Get-DownloadsFolderPathFromRegistry
Write-Host "$downloadsPath"

