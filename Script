Function GetEmailAddressesByControlName(ControlName As String, EAddress_Config As Scripting.Dictionary) As String
    Dim ctrl As Control
    Dim UWAbbrev As String
    Dim emailAddress As String
    Dim emailAddresses As Scripting.Dictionary
    Set emailAddresses = New Scripting.Dictionary
    
    ' 循环遍历Frame_Layout中的每个控件
    For Each ctrl In Frame_Layout.Controls
        ' 检查控件类型是否为ComboBox且名称包含传入的ControlName
        If TypeName(ctrl) = "ComboBox" And InStr(ctrl.Name, ControlName) > 0 Then
            ' 获取ComboBox的值（UW的缩写）
            UWAbbrev = ctrl.Value
            ' 检查缩写是否在EAddress_Config字典中
            If EAddress_Config.Exists(UWAbbrev) Then
                ' 从EAddress_Config字典中获取电子邮件地址
                emailAddress = Split(EAddress_Config(UWAbbrev), "|")(1)
                ' 如果电子邮件地址尚未添加到emailAddresses字典中，则添加它
                If Not emailAddresses.Exists(emailAddress) Then
                    emailAddresses.Add emailAddress, emailAddress
                End If
            End If
        End If
    Next ctrl
    
    ' 将字典中的电子邮件地址合并为一个字符串，用分号隔开
    GetEmailAddressesByControlName = Join(emailAddresses.Keys, ";")
End Function

------------------------------------------------------------------------------------------------------------------------
Function GetLOBListByControlName(ControlName As String) As String
    Dim ctrl As Control
    Dim combinedLOB As String
    Dim lobList As Collection
    Set lobList = New Collection
    
    ' 循环遍历Frame_Layout中的每个控件
    For Each ctrl In Frame_Layout.Controls
        ' 检查控件类型是否为ComboBox且名称包含传入的ControlName
        If TypeName(ctrl) = "ComboBox" And InStr(ctrl.Name, ControlName) > 0 Then
            ' 将LOB信息添加到集合中，避免重复
            On Error Resume Next ' 忽略错误，用于处理尝试添加重复项到集合中的情况
            lobList.Add ctrl.Value, ctrl.Value ' 使用LOB值作为键和项
            On Error GoTo 0 ' 恢复正常的错误处理
        End If
    Next ctrl
    
    ' 根据LOB的数量决定如何组合LOB信息
    If lobList.Count > 0 Then
        For i = 1 To lobList.Count
            ' 检查当前项是否为空，如果不为空，则加入到combinedLOB
            If lobList(i) <> "" Then
                If combinedLOB = "" Then
                    combinedLOB = lobList(i) ' 第一个非空LOB
                Else
                    combinedLOB = combinedLOB & " & " & lobList(i) ' 使用"&"连接后续的非空LOB
                End If
            End If
        Next i
    End If
    
    ' 返回组合后的LOB信息字符串
    GetLOBListByControlName = combinedLOB
End Function
